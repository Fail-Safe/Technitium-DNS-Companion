# Technitium-Sync Environment Configuration
# Example for Technitium DNS v14.0+ (Clustering Enabled)
#
# In v14.0+, when clustering is enabled:
# - Only the Primary node can be modified (Secondary nodes are read-only replicas)
# - Zone transfers and config sync happen automatically within the cluster
# - The app detects cluster state and enables cluster-aware features
#
# Important Notes for v14.0+ Clustering:
# - Interactive UI access should use session auth (Technitium DNS login/RBAC)
# - Only the Primary node can be modified (write operations)
# - Secondary nodes are read-only replicas
# - The Sync tab is hidden for DNS management when clustering is enabled (not needed)
# - Cluster role changes are automatically detected every 30 seconds
# - Write pages (DNS Filtering and DHCP) auto-select the Primary node

## Authentication note (as of v1.2.1)
#
# Preferred (recommended): Technitium-backed session authentication
#   - v1.4+: interactive UI requires session auth (Technitium DNS login/RBAC)
#   - Users log in with their Technitium DNS credentials
#   - Companion stores Technitium session tokens server-side; browser gets an HttpOnly cookie
#   - Run over HTTPS (either enable Companion HTTPS directly, or terminate TLS in a reverse proxy + TRUST_PROXY=true)
#
# Legacy (still supported): env-token mode (legacy/migration only)
#   - Anyone who can reach the Companion UI effectively inherits the privileges of those tokens

## Background Token (read-only, for background jobs) - OPTIONAL
#
# NOTE: Background jobs (e.g., PTR hostname warming, scheduled sync) do not have a user
# session context. If you want background features, set TECHNITIUM_BACKGROUND_TOKEN.
#
# Background timers do not have a user session context.
# If you want background features like PTR hostname warming, set a read-only token here.
# The backend will validate the token on startup and will disable background PTR warming
# if the token is too privileged (Modify/Delete/Admin) or lacks required permissions.
#
# IMPORTANT: This should be a token for a low-privilege Technitium user (read-only).
# Do NOT reuse a full admin token.
#
# TECHNITIUM_BACKGROUND_TOKEN=your-readonly-token

## Session-based Authentication (required for interactive UI in v1.4+)
#
# Reverse proxy configuration (OPTIONAL)
# TRUST_PROXY=true
# TRUST_PROXY_HOPS=1

# Backend HTTPS Configuration
HTTPS_ENABLED=false
HTTPS_PORT=3443
HTTPS_CERT_PATH=/app/certs/fullchain.cer
HTTPS_KEY_PATH=/app/certs/*.yourdomain.arpa.key
HTTPS_CA_PATH=/app/certs/ca.cer

# Comma-separated list of node IDs
# These should match your cluster node names
TECHNITIUM_NODES=primary,secondary1,secondary2

## Legacy env-token mode (legacy/migration only)
#
# ⚠️ WARNING: Anyone who can reach the Companion UI effectively inherits the privileges of these tokens.
# Legacy only (Technitium DNS < v14 / migration): per-node tokens
# TECHNITIUM_PRIMARY_TOKEN=token-for-primary
# TECHNITIUM_SECONDARY1_TOKEN=token-for-secondary1
# TECHNITIUM_SECONDARY2_TOKEN=token-for-secondary2

# Primary Node Configuration
# This is the Primary node in your Technitium cluster
TECHNITIUM_PRIMARY_NAME="Primary DNS"
TECHNITIUM_PRIMARY_BASE_URL=https://primary.yourdomain.arpa:53443

# Secondary Node 1 Configuration
# This is a Secondary (replica) node in your cluster
TECHNITIUM_SECONDARY1_NAME="Secondary DNS 1"
TECHNITIUM_SECONDARY1_BASE_URL=https://secondary1.yourdomain.arpa:53443

# Secondary Node 2 Configuration
# This is another Secondary (replica) node in your cluster
TECHNITIUM_SECONDARY2_NAME="Secondary DNS 2"
TECHNITIUM_SECONDARY2_BASE_URL=https://secondary2.yourdomain.arpa:53443
